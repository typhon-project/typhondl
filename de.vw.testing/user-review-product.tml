
customdatatype address {
	street: string[256],
	city: string[256],
	zipcode: string[42],
	location: point
}

entity Review {
	content : text
	location: point

	product -> Product[1]
	user -> User[1]
}

entity Product {
	name : string[256]
	description : string[256]
	price : int
	productionDate : date
	availabilityRegion: polygon
		
	reviews :-> Review."Review.product"[0..*]
	tags -> Tag[0..*]
	inventory :-> Item[0..*]
	category -> Category[1]
}

entity Category {
	id: string[32]
	name: string[32]
}

entity Item {
	shelf: int
	product -> Product."Product.inventory"[1]
}

entity Tag {
	name: string[64]
}

entity User {
	name : string[256]
	address: string[256]
	billing: address
	location: point
	photoURL: string[256]
	avatarURL: string[256]

	country -> Country [0..1]
	
	biography :-> Biography."Biography.user"[0..1]
	reviews -> Review."Review.user"[0..*]
}

entity Biography {
	content : string[256]
	
	user -> User."User.biography"[1]

}

entity Country {
	name: string[128]
	code: string[4]
}

  


relationaldb Inventory {
	tables {
		table {
			UserDB : User
			index UserNameIndex {
				attributes ("User.name", "User.location")
				references ("User.country")
			}
		}
		table {
			ProductDB : Product
		}
		table { TagDB: Tag }
		table { ItemDB: Item }
	}
}

keyvaluedb Stuff {
	elements {
		User { userKey -> ("User.photoURL", "User.avatarURL") } 
	}
}

documentdb Reviews {
	collections {
		Review : Review
		Biography : Biography
		Category: Category
	}
}

graphdb MoreStuff {
	nodes {
		node AppNode ! Item }
	}
}

