<?xml version="1.0" encoding="UTF-8"?>
<typhonDL:DeploymentModel xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:typhonDL="http://www.typhon.org/dsls/xtext/TyphonDL">
  <guiMetaInformation xsi:type="typhonDL:Import" relativePath="weatherModel.xmi"/>
  <guiMetaInformation xsi:type="typhonDL:Import" relativePath="VehicleMetadataDB.tdl"/>
  <guiMetaInformation xsi:type="typhonDL:Import" relativePath="VehicleDataDB.tdl"/>
  <guiMetaInformation xsi:type="typhonDL:Import" relativePath="AppData.tdl"/>
  <guiMetaInformation xsi:type="typhonDL:Import" relativePath="TextWarningData.tdl"/>
  <guiMetaInformation xsi:type="typhonDL:Import" relativePath="dbTypes.tdl"/>
  <elements xsi:type="typhonDL:ContainerType" name="Docker"/>
  <elements xsi:type="typhonDL:ClusterType" name="Kubernetes"/>
  <elements xsi:type="typhonDL:PlatformType" name="AWS"/>
  <elements xsi:type="typhonDL:Platform" name="platformName" type="//@elements.2">
    <clusters name="clusterName" type="//@elements.1">
      <properties xsi:type="typhonDL:Key_Values" name="kubeConfig" value="myKubeConfig.kubeconfig"/>
      <applications name="Polystore">
        <containers name="vehicledatadb" type="//@elements.0">
          <deploys reference="//@elements.5"/>
          <resources limitCPU="0.5" limitMemory="512M" reservationCPU="0.25" reservationMemory="256M"/>
          <uri value="vehicledatadb:27017"/>
        </containers>
        <containers name="appdata" type="//@elements.0">
          <deploys reference="//@elements.6"/>
          <uri value="appdata:3306"/>
        </containers>
        <containers name="textwarningdata" type="//@elements.0">
          <deploys reference="//@elements.7"/>
          <uri value="textwarningdata:27017"/>
        </containers>
        <containers name="polystore-mongo" type="//@elements.0">
          <deploys reference="//@elements.11"/>
          <uri value="polystore-mongo:27017"/>
        </containers>
        <containers name="typhon-polystore-service" type="//@elements.0">
          <deploys reference="//@elements.12"/>
          <ports>
            <key_values name="target" value="8080"/>
            <key_values name="published" value="30061"/>
          </ports>
          <uri value="typhon-polystore-service:8080"/>
        </containers>
        <containers name="polystore-ui" type="//@elements.0">
          <deploys reference="//@elements.13"/>
          <depends_on reference="//@elements.3/@clusters.0/@applications.0/@containers.4"/>
          <ports>
            <key_values name="target" value="4200"/>
            <key_values name="published" value="30075"/>
          </ports>
          <uri value="polystore-ui:4200"/>
        </containers>
        <containers name="typhonql-server">
          <deploys reference="//@elements.14"/>
          <uri value="typhonql-server:7000"/>
        </containers>
      </applications>
    </clusters>
  </elements>
  <elements xsi:type="typhonDL:DB" name="VehicleMetadataDB" external="true" type="//@elements.8">
    <uri value="https://example.com:35465"/>
    <credentials username="root" password="existingPasword"/>
  </elements>
  <elements xsi:type="typhonDL:DB" name="VehicleDataDB" type="//@elements.9">
    <credentials username="me" password="Byxl7AN2ue3Ixom5"/>
  </elements>
  <elements xsi:type="typhonDL:DB" name="AppData" type="//@elements.10">
    <helm repoName="bitnami" repoAddress="https://charts.bitnami.com/bitnami" chartName="mariadb-galera">
      <parameters xsi:type="typhonDL:Key_Values" name="valuesFile" value="appdata/values.yaml"/>
    </helm>
    <credentials username="root" password="Rrcv0nPqmeYDM2mj"/>
  </elements>
  <elements xsi:type="typhonDL:DB" name="TextWarningData" type="//@elements.9">
    <credentials username="me" password="tZd0bqXvqkF1oJxk"/>
  </elements>
  <elements xsi:type="typhonDL:DBType" name="MariaDB">
    <image value="mariadb:latest"/>
  </elements>
  <elements xsi:type="typhonDL:DBType" name="Mongo">
    <image value="mongo:latest"/>
  </elements>
  <elements xsi:type="typhonDL:DBType" name="mariadbgalera">
    <image value="bitnami/mariadb-galera"/>
  </elements>
  <elements xsi:type="typhonDL:DB" name="polystore_db" type="//@elements.9">
    <credentials username="admin" password="admin"/>
  </elements>
  <elements xsi:type="typhonDL:Software" name="polystore_api">
    <image value="clms/typhon-polystore-api:latest"/>
  </elements>
  <elements xsi:type="typhonDL:Software" name="polystore_ui">
    <image value="clms/typhon-polystore-ui:latest"/>
    <parameters xsi:type="typhonDL:Key_KeyValueList" name="environment">
      <properties xsi:type="typhonDL:Key_Values" name="API_PORT" value="&quot;30061&quot;"/>
      <properties xsi:type="typhonDL:Key_Values" name="API_HOST" value="&quot;192.168.99.101&quot;"/>
    </parameters>
  </elements>
  <elements xsi:type="typhonDL:Software" name="polystore_ql">
    <image value="swatengineering/typhonql-server"/>
  </elements>
  <elements xsi:type="typhonDL:Software" name="Kafka"/>
</typhonDL:DeploymentModel>
